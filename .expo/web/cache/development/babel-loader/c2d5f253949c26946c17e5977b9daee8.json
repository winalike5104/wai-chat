{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useEffect, useLayoutEffect, useState, useRef } from 'react';\nimport { BASE_URL } from \"../constants\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport StatusBar from \"react-native-web/dist/exports/StatusBar\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport TouchableWithoutFeedback from \"react-native-web/dist/exports/TouchableWithoutFeedback\";\nimport Linking from \"react-native-web/dist/exports/Linking\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport { Avatar, ListItem } from \"react-native-elements\";\nimport { AntDesign } from \"@expo/vector-icons\";\nimport * as ImagePicker from 'expo-image-picker';\nimport { Audio } from 'expo-av';\nimport FontAwesome from \"@expo/vector-icons/FontAwesome\";\nimport Ionicons from \"@expo/vector-icons/Ionicons\";\nimport axios from \"axios\";\nimport * as SecureStore from \"expo-secure-store\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\n\nvar ChatDetailScreen = function ChatDetailScreen(_ref) {\n  var navigation = _ref.navigation,\n      route = _ref.route;\n\n  var _useState = useState({\n    chatters: []\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      room = _useState2[0],\n      setRoom = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      users = _useState4[0],\n      setUsers = _useState4[1];\n\n  var _useState5 = useState(true),\n      _useState6 = _slicedToArray(_useState5, 2),\n      loading = _useState6[0],\n      setLoading = _useState6[1];\n\n  var _route$params = route.params,\n      chatID = _route$params.chatID,\n      chatName = _route$params.chatName,\n      token = _route$params.token,\n      userID = _route$params.userID,\n      phoneNumber = _route$params.phoneNumber;\n  useEffect(function () {\n    (function _callee() {\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              loadData();\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    })();\n  }, []);\n\n  var loadData = function loadData() {\n    return _regeneratorRuntime.async(function loadData$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            console.log(\"token\", token);\n            _context3.next = 3;\n            return _regeneratorRuntime.awrap(axios.get(BASE_URL + 'api/chatroom/' + chatID, {\n              headers: {\n                'Authorization': \"Token \" + token\n              }\n            }).then(function _callee2(response) {\n              var rm;\n              return _regeneratorRuntime.async(function _callee2$(_context2) {\n                while (1) {\n                  switch (_context2.prev = _context2.next) {\n                    case 0:\n                      rm = response.data;\n                      _context2.next = 3;\n                      return _regeneratorRuntime.awrap(axios.get(BASE_URL + 'api/showAllUsers/', {\n                        headers: {\n                          'Authorization': \"Token \" + token\n                        }\n                      }).then(function (response) {\n                        setRoom(rm);\n                        setLoading(false);\n                        var us = response.data.user.filter(function (item) {\n                          return rm.chatters.includes(item.id);\n                        });\n                        console.log(\"response.data2222\", response.data, us, rm.chatters);\n                        setUsers(us);\n                      }).catch(function (error) {\n                        console.log(\"no token\");\n                        console.log(error);\n                      }));\n\n                    case 3:\n                    case \"end\":\n                      return _context2.stop();\n                  }\n                }\n              }, null, null, null, Promise);\n            }).catch(function (error) {\n              console.log(\"no token\");\n              console.log(error);\n            }));\n\n          case 3:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var addUser = function addUser() {\n    navigation.navigate(\"selectUser\", {\n      chatID: chatID,\n      chatName: chatName,\n      token: token,\n      userID: userID,\n      phoneNumber: phoneNumber\n    });\n\n    navigation.callBack = function () {\n      loadData();\n    };\n  };\n\n  useLayoutEffect(function () {\n    navigation.setOptions({\n      title: \"Detail\",\n      headerStyle: {\n        backgroundColor: \"#3B5F41\"\n      },\n      headerTitleStyle: {\n        color: \"white\"\n      },\n      headerTintColor: \"black\",\n      headerBackTitleVisible: false,\n      headerTitleAlign: \"left\",\n      headerTitle: function headerTitle() {\n        return _jsxs(View, {\n          style: {\n            flexDirection: \"row\",\n            alignItems: \"center\"\n          },\n          children: [_jsx(Avatar, {\n            rounded: true,\n            source: require(\"../assets/young-user-icon.jpg\")\n          }), _jsx(Text, {\n            style: {\n              color: \"white\",\n              marginLeft: 10,\n              fontWeight: \"700\"\n            },\n            children: chatName\n          })]\n        });\n      },\n      headerLeft: function headerLeft() {\n        return _jsx(TouchableOpacity, {\n          style: {\n            marginLeft: 10\n          },\n          onPress: navigation.goBack,\n          children: _jsx(AntDesign, {\n            name: \"arrowleft\",\n            size: 24,\n            color: 'white'\n          })\n        });\n      }\n    });\n  }, []);\n\n  var deleteUser = function deleteUser(user, i) {\n    users.splice(i, 1);\n    setUsers(_objectSpread({}, users));\n    axios.patch(BASE_URL + 'api/chatroom/' + room.id + \"/\", {\n      \"id\": room.id,\n      \"name\": room.name,\n      \"created_at\": room.created_at,\n      \"chatroomtype\": room.chatroomtype,\n      \"creator\": room.creator,\n      \"chatters\": room.chatters\n    }, {\n      headers: {\n        'Authorization': \"Token \" + token\n      }\n    }).then(function _callee3(response) {\n      return _regeneratorRuntime.async(function _callee3$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              console.log(response.data);\n\n            case 1:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }).catch(function (err) {\n      return alert(\"Send Failed\");\n    });\n  };\n\n  return _jsxs(SafeAreaView, {\n    style: {\n      flex: 1,\n      backgroundColor: \"#F2F2F2\"\n    },\n    children: [_jsx(StatusBar, {\n      style: \"light\"\n    }), _jsx(KeyboardAvoidingView, {\n      behavior: Platform.OS === \"ios\" ? \"padding\" : \"height\",\n      style: styles.container,\n      keyboardVerticalOffset: 90,\n      children: _jsx(TouchableWithoutFeedback, {\n        onPress: Keyboard.dismiss,\n        children: !loading ? _jsx(_Fragment, {\n          children: _jsxs(ScrollView, {\n            contentContainerStyle: {\n              paddingTop: 15,\n              backgroundColor: '#F2F2F2'\n            },\n            ref: function ref(_ref2) {\n              scrollView = _ref2;\n            },\n            onContentSizeChange: function onContentSizeChange() {\n              return scrollView.scrollToEnd({\n                animated: true\n              });\n            },\n            children: [_jsx(View, {\n              children: users.map(function (user, i) {\n                return _jsxs(View, {\n                  style: styles.reciever,\n                  children: [_jsx(Avatar, {\n                    source: require(\"../assets/young-user-icon.jpg\"),\n                    rounded: true,\n                    size: 30\n                  }), _jsx(Text, {\n                    style: styles.nicknameText,\n                    children: user.first_name + ' ' + user.last_name\n                  }), _jsx(TouchableOpacity, {\n                    onPress: function onPress() {\n                      deleteUser(user, i);\n                    },\n                    activeOpacity: 0.5,\n                    children: _jsx(View, {\n                      style: styles.imageOutline,\n                      children: _jsx(Text, {\n                        style: styles.deleteText,\n                        children: \"delete\"\n                      })\n                    })\n                  })]\n                }, user.id);\n              })\n            }), _jsx(Button, {\n              title: \"Add user\",\n              onPress: function onPress() {\n                addUser();\n              }\n            })]\n          })\n        }) : _jsx(Text, {\n          children: \"loading\"\n        })\n      })\n    })]\n  });\n};\n\nexport default ChatDetailScreen;\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1\n  },\n  footer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    width: \"100%\",\n    padding: 15\n  },\n  textInput: {\n    bottom: 0,\n    height: 40,\n    flex: 1,\n    marginRight: 15,\n    borderColor: \"transparent\",\n    backgroundColor: \"#ECECEC\",\n    padding: 10,\n    color: \"gray\",\n    borderRadius: 30\n  },\n  imageOutline: {\n    marginLeft: 10\n  },\n  micOutline: {},\n  picture: {\n    width: 150,\n    height: 150\n  },\n  nicknameText: {\n    color: \"black\",\n    fontWeight: \"500\",\n    marginLeft: 10,\n    flex: 1\n  },\n  deleteText: {\n    color: \"#6576ff\",\n    fontWeight: \"500\",\n    marginLeft: 10\n  },\n  senderText: {\n    color: \"black\",\n    fontWeight: \"500\",\n    marginLeft: 10,\n    marginBottom: 15\n  },\n  reciever: {\n    padding: 15,\n    display: \"flex\",\n    flexDirection: \"row\",\n    alignItems: \"center\"\n  },\n  sender: {\n    paddingTop: 5,\n    paddingBottom: 5,\n    paddingHorizontal: 15,\n    backgroundColor: \"white\",\n    alignSelf: \"flex-start\",\n    borderTopLeftRadius: 0,\n    borderTopRightRadius: 20,\n    borderBottomLeftRadius: 20,\n    borderBottomRightRadius: 20,\n    marginLeft: 45,\n    marginRight: 20,\n    marginBottom: 20,\n    maxWidth: \"80%\",\n    position: \"relative\"\n  },\n  senderName: {\n    left: 10,\n    paddingRight: 10,\n    fontSize: 10,\n    color: \"grey\"\n  }\n});","map":{"version":3,"sources":["C:/Users/sanli/Desktop/backup/wai-chat-master(1)/screens/ChatDetailScreen.js"],"names":["React","useEffect","useLayoutEffect","useState","useRef","BASE_URL","Avatar","ListItem","AntDesign","ImagePicker","Audio","FontAwesome","Ionicons","axios","SecureStore","ChatDetailScreen","navigation","route","chatters","room","setRoom","users","setUsers","loading","setLoading","params","chatID","chatName","token","userID","phoneNumber","loadData","console","log","get","headers","then","response","rm","data","us","user","filter","item","includes","id","catch","error","addUser","navigate","callBack","setOptions","title","headerStyle","backgroundColor","headerTitleStyle","color","headerTintColor","headerBackTitleVisible","headerTitleAlign","headerTitle","flexDirection","alignItems","require","marginLeft","fontWeight","headerLeft","goBack","deleteUser","i","splice","patch","name","created_at","chatroomtype","creator","err","alert","flex","Platform","OS","styles","container","Keyboard","dismiss","paddingTop","ref","scrollView","scrollToEnd","animated","map","reciever","nicknameText","first_name","last_name","imageOutline","deleteText","StyleSheet","create","footer","width","padding","textInput","bottom","height","marginRight","borderColor","borderRadius","micOutline","picture","senderText","marginBottom","display","sender","paddingBottom","paddingHorizontal","alignSelf","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","maxWidth","position","senderName","left","paddingRight","fontSize"],"mappings":"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","sourcesContent":["import React, { useEffect, useLayoutEffect, useState, useRef } from 'react';\n//import { GiftedChat } from 'react-native-gifted-chat'\nimport { BASE_URL } from \"../constants\";\nimport {\n  StyleSheet,\n  KeyboardAvoidingView,\n  SafeAreaView,\n  StatusBar,\n  Text,\n  TouchableOpacity,\n  View,\n  Button,\n  Platform, ScrollView, TextInput, Keyboard, TouchableWithoutFeedback, Linking,\n  Image\n} from 'react-native';\nimport { Avatar, ListItem } from \"react-native-elements\";\nimport { AntDesign } from \"@expo/vector-icons\";\nimport * as ImagePicker from 'expo-image-picker';\nimport { Audio } from 'expo-av';\n\n// import {AudioRecorder, AudioUtils} from 'react-native-audio';\n\nimport FontAwesome from \"react-native-vector-icons/FontAwesome\";\nimport Ionicons from \"react-native-vector-icons/Ionicons\";\nimport axios from \"axios\";\nimport * as SecureStore from \"expo-secure-store\";\n\nconst ChatDetailScreen = ({ navigation, route }) => {\n  // const BASE_URL = 'https://wai-chat-api.herokuapp.com/';\n  const [room, setRoom] = useState({\n    chatters: []\n  })\n  const [users, setUsers] = useState([])\n\n  const [loading, setLoading] = useState(true);\n  const { chatID, chatName, token, userID, phoneNumber } = route.params;\n\n\n  useEffect(() => {\n\n    (async () => {\n      loadData();\n    })()\n  }, [])\n\n  const loadData = async ()=>{\n    console.log(\"token\", token);\n      await axios.get(BASE_URL + 'api/chatroom/' + chatID, {\n        headers: {\n          'Authorization': `Token ` + token\n        }\n      }).then(async function (response) {\n        let rm = response.data;\n       \n\n        await axios.get(BASE_URL + 'api/showAllUsers/', {\n          headers: {\n            'Authorization': `Token ` + token\n          }\n        }).then(function (response) {\n          setRoom(rm)\n          setLoading(false);\n          let us = response.data.user.filter((item)=>{\n            return rm.chatters.includes(item.id);\n          })\n          console.log(\"response.data2222\", response.data,us,rm.chatters);\n\n          setUsers(us)\n          // handle success\n        }).catch(function (error) {\n          // handle error\n          console.log(\"no token\");\n          console.log(error);\n          // navigation.navigate(\"login\");\n        });\n\n        // handle success\n      }).catch(function (error) {\n        // handle error\n        console.log(\"no token\");\n        console.log(error);\n        // navigation.navigate(\"login\");\n      });\n  }\n\n  \n\n\n  const addUser = () => {\n    navigation.navigate(\"selectUser\", {\n      chatID: chatID,\n      chatName: chatName,\n      token: token,\n      userID: userID,\n      phoneNumber: phoneNumber,\n      \n    })\n\n    navigation.callBack=()=>{\n      loadData();\n    }\n  }\n\n\n  useLayoutEffect(() => {\n    navigation.setOptions({\n      title: \"Detail\",\n      headerStyle: { backgroundColor: \"#3B5F41\" },\n      headerTitleStyle: { color: \"white\" },\n      headerTintColor: \"black\",\n      headerBackTitleVisible: false,\n      headerTitleAlign: \"left\",\n      headerTitle: () => (\n        <View style={{\n          flexDirection: \"row\",\n          alignItems: \"center\",\n        }}>\n          <Avatar\n            rounded\n            source={require(\"../assets/young-user-icon.jpg\")}\n          />\n          <Text style={{\n            color: \"white\",\n            marginLeft: 10,\n            fontWeight: \"700\"\n          }}>\n            {chatName}\n          </Text>\n        </View>\n      ),\n      headerLeft: () => (\n        <TouchableOpacity style={{\n          marginLeft: 10,\n        }} onPress={navigation.goBack}>\n          <AntDesign name={\"arrowleft\"} size={24} color={'white'} />\n        </TouchableOpacity>\n      )\n    })\n  }, [])\n\n\n\n  const deleteUser = (user, i) => {\n    users.splice(i, 1);\n    setUsers({ ...users });\n    // create message\n    axios.patch(BASE_URL + 'api/chatroom/' + room.id + \"/\",\n      {\n        \"id\": room.id,\n        \"name\": room.name,\n        \"created_at\": room.created_at,\n        \"chatroomtype\": room.chatroomtype,\n        \"creator\": room.creator,\n        \"chatters\": room.chatters\n      }, {\n      headers: {\n        'Authorization': `Token ` + token\n      }\n    },\n    ).then(async response => {\n      console.log(response.data);\n\n    }).catch(err => alert(\"Send Failed\"))\n\n\n\n\n  };\n\n\n  return (\n\n    <SafeAreaView style={{\n      flex: 1,\n      backgroundColor: \"#F2F2F2\"\n    }}>\n      <StatusBar style={\"light\"} />\n      <KeyboardAvoidingView\n        behavior={Platform.OS === \"ios\" ? \"padding\" : \"height\"}\n        style={styles.container}\n        keyboardVerticalOffset={90}\n      >\n        <TouchableWithoutFeedback onPress={Keyboard.dismiss}>\n          {!loading ?\n            <>\n              <ScrollView\n                contentContainerStyle={{ paddingTop: 15, backgroundColor: '#F2F2F2' }}\n                //自动到最下\n                ref={ref => {\n                  scrollView = ref\n                }}\n                onContentSizeChange={() => scrollView.scrollToEnd({ animated: true })}>\n                <View>\n                  {users.map((user, i) => (\n                    //收\n                    <View key={user.id} style={styles.reciever}>\n                      <Avatar\n                        source={require(\"../assets/young-user-icon.jpg\")}\n                        rounded\n                        size={30}\n                      />\n                      <Text style={styles.nicknameText}>{user.first_name + ' '+user.last_name}</Text>\n                      <TouchableOpacity onPress={() => {\n                        deleteUser(user, i);\n                      }} activeOpacity={0.5}>\n                        <View style={styles.imageOutline}>\n                          <Text style={styles.deleteText}>delete</Text>\n                        </View>\n                      </TouchableOpacity>\n                    </View>\n                  ))}\n                </View>\n                <Button title=\"Add user\" onPress={() => {\n                  addUser()\n                }} />\n\n              </ScrollView>\n            </>\n            : <Text>loading</Text>}\n\n\n\n        </TouchableWithoutFeedback>\n      </KeyboardAvoidingView>\n    </SafeAreaView>\n\n  );\n};\n\nexport default ChatDetailScreen;\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  footer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    width: \"100%\",\n    padding: 15,\n  },\n  textInput: {\n    bottom: 0,\n    height: 40,\n    flex: 1,\n    marginRight: 15,\n    borderColor: \"transparent\",\n    backgroundColor: \"#ECECEC\",\n    // borderWidth:1,\n    padding: 10,\n    color: \"gray\",\n    borderRadius: 30,\n  },\n  imageOutline: {\n    marginLeft: 10\n  },\n  micOutline: {\n\n  },\n  picture: {\n    width: 150,\n    height: 150\n  },\n  nicknameText: {\n    color: \"black\",\n    fontWeight: \"500\",\n    marginLeft: 10,\n    flex: 1\n  },\n  deleteText: {\n    color: \"#6576ff\",\n    fontWeight: \"500\",\n    marginLeft: 10,\n  },\n  senderText: {\n    color: \"black\",\n    fontWeight: \"500\",\n    marginLeft: 10,\n    marginBottom: 15,\n  },\n  reciever: {\n    padding: 15,\n    display: \"flex\",\n    flexDirection: \"row\",\n    alignItems: \"center\"\n  },\n  sender: {\n    paddingTop: 5,\n    paddingBottom: 5,\n    paddingHorizontal: 15,\n    backgroundColor: \"white\",\n    alignSelf: \"flex-start\",\n    borderTopLeftRadius: 0,\n    borderTopRightRadius: 20,\n    borderBottomLeftRadius: 20,\n    borderBottomRightRadius: 20,\n    marginLeft: 45,\n    marginRight: 20,\n    marginBottom: 20,\n    maxWidth: \"80%\",\n    position: \"relative\",\n  },\n  senderName: {\n    left: 10,\n    paddingRight: 10,\n    fontSize: 10,\n    color: \"grey\",\n  }\n})"]},"metadata":{},"sourceType":"module"}